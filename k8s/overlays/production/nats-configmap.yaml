apiVersion: v1
kind: ConfigMap
metadata:
  name: nats-config
  namespace: batchsender
data:
  nats.conf: |
    # NATS Server Configuration with TLS (Production single-node)

    # Server identification
    server_name: $POD_NAME

    # Client connections (TLS)
    port: 4222
    tls {
      cert_file: /etc/nats-certs/tls.crt
      key_file: /etc/nats-certs/tls.key
      ca_file: /etc/nats-certs/ca.crt
      verify: false  # Don't require client certs
      timeout: 2
    }

    # No cluster config for single-node setup

    # JetStream storage
    jetstream {
      store_dir: /data
      max_mem: 1G
      max_file: 40G
    }

    # Monitoring endpoint (no TLS for internal metrics scraping)
    http_port: 8222

    # Logging
    debug: false
    trace: false
    logtime: true
